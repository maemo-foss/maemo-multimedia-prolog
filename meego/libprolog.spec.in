Summary: A convenience library Nokia policy engine prolog library
Name: libprolog
Version: ##__VERSION__##
Release: 1
License: LGPLv2.1
Group: System/Libraries
URL: http://meego.gitorious.org/maemo-multimedia/prolog
Source0: %{name}-%{version}.tar.gz
BuildRoot: %{_tmppath}/%{name}-%{version}-%{release}-root
BuildRequires: pkgconfig(ohm)
BuildRequires: pkgconfig(glib-2.0)
BuildRequires: pkgconfig(dbus-glib-1)
BuildRequires: pkgconfig(swi-prolog)
#BuildRequires: swi-prolog-devel
Requires: pl >= 5.6.32

%package devel
Summary: Files necessary for developing with the prolog convenience library
Group: Development/Libraries
Requires: %{name} = %{version}

%package -n prolog-extensions
Summary: Prolog extensions for the Nokia policy framework
Group: Development/Libraries

%package -n ohm-plugin-ruleengine
Summary: A prolog-based OHM rule engine plugin
Group: System/Daemons
Requires: ohm

%description
The prolog convenience library contains a small set of functions that
are supposed to make embedding the SWI-prolog interpreter easier.

%description devel
This package contains files necessary for developing with the prolog
convenience library.

%description -n prolog-extensions
A set of prolog extensions needed by the policy framework (and/or its
prototype implementation).

%description -n ohm-plugin-ruleengine
A prolog-based OHM rule engine plugin.

%prep
%setup -q

%build
./autogen.sh
%configure --disable-static --enable-extra-warnings
make

%install
rm -rf $RPM_BUILD_ROOT
make DESTDIR=$RPM_BUILD_ROOT install
rm -f $RPM_BUILD_ROOT%{_libdir}/*.la
rm -f $RPM_BUILD_ROOT%{_libdir}/ohm/*.la

%clean
rm -rf $RPM_BUILD_ROOT

%post -p /sbin/ldconfig

%postun -p /sbin/ldconfig

%post -n prolog-extensions -p /sbin/ldconfig

%postun -n prolog-extensions -p /sbin/ldconfig


%files
%defattr(-,root,root,-)
%{_libdir}/*.so.*
%{_datadir}/libprolog
%doc README COPYING INSTALL AUTHORS NEWS ChangeLog

%files devel
%defattr(-,root,root,-)
%{_includedir}/prolog
%{_libdir}/*.so
%{_libdir}/pkgconfig/*

%files -n prolog-extensions
%defattr(-,root,root,-)
%{_libdir}/prolog/extensions

%files -n ohm-plugin-ruleengine
%defattr(-,root,root,-)
%{_libdir}/ohm/libohm_rule_engine.so
%config %{_sysconfdir}/ohm/plugins.d/rule_engine.ini
